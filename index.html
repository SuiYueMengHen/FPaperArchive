<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FPaper | 高考真题与模拟题资源库</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* 基础变量 - 默认浅绿色系 */
:root {
  --primary: #10b981;
  --primary-dark: #0ea271;
  --secondary: #3b82f6;
  --accent: #f59e0b;
  --success: #10b981;
  --warning: #f59e0b;
  --danger: #ef4444;
  --light: #f8fafc;
  --dark: #1e293b;
  --gray-100: #f1f5f9;
  --gray-200: #e2e8f0;
  --gray-300: #cbd5e1;
  --gray-400: #94a3b8;
  --gray-500: #64748b;
  --gray-600: #475569;
  --gray-700: #334155;
  --gray-800: #1e293b;
  --gray-900: #0f172a;
  --gradient-primary: linear-gradient(135deg, #10b981 0%, #0d9668 100%);
  --gradient-secondary: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
  --gradient-accent: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
  --gradient-dark: linear-gradient(135deg, #1e293b 0%, #334155 100%);
  --shadow-sm: 0 2px 4px rgba(0,0,0,0.05);
  --shadow-md: 0 4px 8px rgba(0,0,0,0.08);
  --shadow-lg: 0 8px 16px rgba(0,0,0,0.1);
  --shadow-xl: 0 12px 24px rgba(0,0,0,0.12);
  --shadow-xxl: 0 20px 40px rgba(0,0,0,0.15);
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  --radius-xl: 24px;
  --radius-round: 50%;
  --transition-fast: 0.2s ease;
  --transition-normal: 0.3s ease;
  --transition-slow: 0.5s ease;
  --font-heading: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  --font-body: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  --bg-color: #f9fafb;
  --card-bg: #ffffff;
  --text-color: var(--gray-800);
  --header-bg: rgba(255, 255, 255, 0.95);
  --footer-bg: var(--gradient-dark);
  --border-color: var(--gray-200);
  --mode: 'light';
}

/* 夜间模式变量 */
[data-theme="dark"] {
  --primary: #e5e7eb;
  --primary-dark: #d1d5db;
  --secondary: #9ca3af;
  --accent: #fbbf24;
  --success: #34d399;
  --warning: #fbbf24;
  --danger: #f87171;
  --light: #111827;
  --dark: #f9fafb;
  --gray-100: #1f2937;
  --gray-200: #374151;
  --gray-300: #4b5563;
  --gray-400: #6b7280;
  --gray-500: #9ca3af;
  --gray-600: #d1d5db;
  --gray-700: #e5e7eb;
  --gray-800: #f3f4f6;
  --gray-900: #f9fafb;
  --gradient-primary: linear-gradient(135deg, #374151 0%, #1f2937 100%);
  --gradient-secondary: linear-gradient(135deg, #4b5563 0%, #374151 100%);
  --gradient-accent: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
  --gradient-dark: linear-gradient(135deg, #111827 0%, #1f2937 100%);
  --shadow-sm: 0 2px 4px rgba(0,0,0,0.5);
  --shadow-md: 0 4px 8px rgba(0,0,0,0.6);
  --shadow-lg: 0 8px 16px rgba(0,0,0,0.7);
  --shadow-xl: 0 12px 24px rgba(0,0,0,0.75);
  --shadow-xxl: 0 20px 40px rgba(0,0,0,0.8);
  --bg-color: #111827;
  --card-bg: #1f2937;
  --text-color: #f9fafb;
  --header-bg: rgba(31, 41, 55, 0.95);
  --footer-bg: var(--gradient-dark);
  --border-color: #374151;
}

/* 重置和基础样式 */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: var(--font-body);
  font-size: 16px;
  line-height: 1.6;
  color: var(--text-color);
  background-color: var(--bg-color);
  overflow-x: hidden;
  transition: background-color var(--transition-normal), color var(--transition-normal);
}

h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-heading);
  font-weight: 700;
  line-height: 1.2;
  margin-bottom: 1rem;
}

a {
  text-decoration: none;
  color: inherit;
  transition: color var(--transition-fast);
}

ul {
  list-style: none;
}

button, input, select, textarea {
  font-family: inherit;
  font-size: inherit;
}

.container {
  width: 100%;
  max-width: 1280px;
  margin: 0 auto;
  padding: 0 20px;
}

/* 动画 */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes slideInLeft {
  from { opacity: 0; transform: translateX(-20px); }
  to { opacity: 1; transform: translateX(0); }
}

@keyframes slideInRight {
  from { opacity: 0; transform: translateX(20px); }
  to { opacity: 1; transform: translateX(0); }
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

@keyframes shimmer {
  0% { background-position: -1000px 0; }
  100% { background-position: 1000px 0; }
}

@keyframes slideInFromRight {
  from { 
    opacity: 0;
    transform: translateX(100%) translateY(-50%);
  }
  to { 
    opacity: 1;
    transform: translateX(0) translateY(-50%);
  }
}

@keyframes slideOutToRight {
  from { 
    opacity: 1;
    transform: translateX(0) translateY(-50%);
  }
  to { 
    opacity: 0;
    transform: translateX(100%) translateY(-50%);
  }
}

@keyframes navLinkSlideInLeft {
  from { transform: translateX(-100%); }
  to { transform: translateX(0); }
}

@keyframes navLinkSlideInRight {
  from { transform: translateX(100%); }
  to { transform: translateX(0); }
}

@keyframes pageTransitionIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes colorChange {
  0% { filter: hue-rotate(0deg) brightness(1); }
  50% { filter: hue-rotate(180deg) brightness(1.2); }
  100% { filter: hue-rotate(360deg) brightness(1); }
}

.animate-fade-in {
  animation: fadeIn 0.5s ease forwards;
}

.animate-slide-left {
  animation: slideInLeft 0.5s ease forwards;
}

.animate-slide-right {
  animation: slideInRight 0.5s ease forwards;
}

.animate-pulse {
  animation: pulse 2s infinite;
}

.animate-float {
  animation: float 3s ease-in-out infinite;
}

.animate-page-in {
  animation: pageTransitionIn 0.4s ease-out forwards;
}

.animate-color-change {
  animation: colorChange 0.8s ease;
}

/* 加载动画 */
.shimmer {
  background: linear-gradient(90deg, var(--gray-100) 25%, var(--gray-200) 50%, var(--gray-100) 75%);
  background-size: 1000px 100%;
  animation: shimmer 2s infinite;
}

/* 提示框容器 */
.toast-container {
  position: fixed;
  top: 100px;
  right: 20px;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: 10px;
  max-width: 350px;
  pointer-events: none;
}

/* 提示框样式 */
.toast {
  position: relative;
  background: var(--card-bg);
  border-radius: var(--radius-md);
  padding: 16px 20px;
  box-shadow: var(--shadow-lg);
  border-left: 4px solid var(--primary);
  animation: slideInFromRight 0.3s ease-out forwards;
  pointer-events: auto;
  transform: translateY(-50%);
  margin-bottom: 10px;
  transition: transform 0.3s ease, opacity 0.3s ease;
}

.toast.fade-out {
  animation: slideOutToRight 0.3s ease-in forwards;
}

.toast-success {
  border-left-color: var(--success);
}

.toast-error {
  border-left-color: var(--danger);
}

.toast-info {
  border-left-color: var(--primary);
}

.toast-warning {
  border-left-color: var(--warning);
}

.toast-content {
  display: flex;
  align-items: center;
  gap: 12px;
}

.toast-icon {
  font-size: 18px;
  flex-shrink: 0;
}

.toast-message {
  flex-grow: 1;
  font-size: 14px;
  line-height: 1.4;
}

.toast-close {
  background: none;
  border: none;
  color: var(--gray-500);
  cursor: pointer;
  font-size: 14px;
  padding: 0;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  transition: color var(--transition-fast);
}

.toast-close:hover {
  color: var(--danger);
}

/* 顶部导航栏 */
.navbar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background: var(--header-bg);
  backdrop-filter: blur(10px);
  box-shadow: var(--shadow-md);
  z-index: 1000;
  padding: 15px 0;
  transition: all var(--transition-normal);
}

.navbar.scrolled {
  padding: 10px 0;
  box-shadow: var(--shadow-lg);
}

.navbar-container {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.navbar-brand {
  display: flex;
  align-items: center;
  gap: 12px;
}

.logo {
  width: 40px;
  height: 40px;
  background: var(--gradient-primary);
  border-radius: var(--radius-md);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 700;
  font-size: 20px;
  box-shadow: var(--shadow-md);
  transition: all var(--transition-fast);
}

.logo-text {
  font-size: 24px;
  font-weight: 800;
  background: var(--gradient-primary);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.nav-links {
  display: flex;
  gap: 30px;
  align-items: center;
  position: relative;
}

.nav-link {
  font-weight: 600;
  color: var(--gray-700);
  padding: 8px 16px;
  border-radius: var(--radius-md);
  transition: all var(--transition-fast);
  position: relative;
  cursor: pointer;
  overflow: hidden;
}

.nav-link:hover {
  color: var(--primary);
  background-color: rgba(var(--primary-rgb, 16, 185, 129), 0.1);
}

.nav-link.active {
  color: white;
  background: var(--gradient-primary);
  box-shadow: var(--shadow-md);
}

.nav-link.active::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 3px;
  background-color: white;
  border-radius: 3px;
}

/* 主题控制按钮 */
.theme-controls {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-left: 20px;
}

.theme-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  border-radius: var(--radius-round);
  background: var(--gray-100);
  border: 1px solid var(--border-color);
  color: var(--gray-700);
  cursor: pointer;
  transition: all var(--transition-fast);
}

.theme-btn:hover {
  background: var(--gray-200);
  transform: translateY(-2px);
}

.color-picker-btn {
  position: relative;
}

.color-picker-menu {
  position: absolute;
  top: 50px;
  right: 0;
  background: var(--card-bg);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-lg);
  padding: 20px;
  z-index: 1001;
  display: none;
  width: 300px;
  max-height: 400px;
  overflow-y: auto;
}

.color-picker-menu.show {
  display: block;
  animation: fadeIn 0.3s ease;
}

.color-picker-tabs {
  display: flex;
  margin-bottom: 15px;
  border-bottom: 1px solid var(--border-color);
}

.color-tab {
  flex: 1;
  padding: 10px;
  text-align: center;
  cursor: pointer;
  border-bottom: 2px solid transparent;
  transition: all var(--transition-fast);
}

.color-tab.active {
  border-bottom-color: var(--primary);
  color: var(--primary);
  font-weight: 600;
}

.color-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 10px;
  margin-bottom: 15px;
}

.color-option {
  width: 30px;
  height: 30px;
  border-radius: var(--radius-round);
  cursor: pointer;
  border: 2px solid transparent;
  transition: all var(--transition-fast);
}

.color-option:hover {
  transform: scale(1.1);
  border-color: var(--gray-300);
}

.color-option.active {
  border-color: var(--primary);
  box-shadow: 0 0 0 2px rgba(var(--primary-rgb, 16, 185, 129), 0.3);
}

.color-preview {
  width: 100%;
  height: 40px;
  border-radius: var(--radius-md);
  margin-bottom: 15px;
  transition: all var(--transition-fast);
}

.rgb-inputs {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 10px;
  margin-bottom: 15px;
}

.rgb-input {
  display: flex;
  flex-direction: column;
  gap: 5px;
}

.rgb-input label {
  font-size: 12px;
  color: var(--gray-600);
}

.rgb-input input {
  padding: 8px;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  background: var(--card-bg);
  color: var(--text-color);
}

.apply-color-btn {
  width: 100%;
  padding: 12px;
  background: var(--gradient-primary);
  color: white;
  border: none;
  border-radius: var(--radius-md);
  cursor: pointer;
  font-weight: 600;
  transition: all var(--transition-fast);
}

.apply-color-btn:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

/* 20种颜色主题 */
.color-option[data-color="green"] {
  background: linear-gradient(135deg, #10b981 0%, #0d9668 100%);
}

.color-option[data-color="blue"] {
  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
}

.color-option[data-color="purple"] {
  background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
}

.color-option[data-color="red"] {
  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
}

.color-option[data-color="orange"] {
  background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
}

.color-option[data-color="teal"] {
  background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%);
}

.color-option[data-color="pink"] {
  background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);
}

.color-option[data-color="indigo"] {
  background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
}

.color-option[data-color="cyan"] {
  background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
}

.color-option[data-color="lime"] {
  background: linear-gradient(135deg, #84cc16 0%, #65a30d 100%);
}

.color-option[data-color="amber"] {
  background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
}

.color-option[data-color="rose"] {
  background: linear-gradient(135deg, #f43f5e 0%, #e11d48 100%);
}

.color-option[data-color="violet"] {
  background: linear-gradient(135deg, #a855f7 0%, #9333ea 100%);
}

.color-option[data-color="emerald"] {
  background: linear-gradient(135deg, #10b981 0%, #059669 100%);
}

.color-option[data-color="sky"] {
  background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
}

.color-option[data-color="fuchsia"] {
  background: linear-gradient(135deg, #d946ef 0%, #c026d3 100%);
}

.color-option[data-color="yellow"] {
  background: linear-gradient(135deg, #eab308 0%, #ca8a04 100%);
}

.color-option[data-color="stone"] {
  background: linear-gradient(135deg, #78716c 0%, #57534e 100%);
}

.color-option[data-color="neutral"] {
  background: linear-gradient(135deg, #737373 0%, #525252 100%);
}

.color-option[data-color="zinc"] {
  background: linear-gradient(135deg, #71717a 0%, #52525b 100%);
}

/* 按钮样式 */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 12px 24px;
  font-weight: 600;
  border-radius: var(--radius-md);
  border: none;
  cursor: pointer;
  transition: all var(--transition-fast);
  gap: 8px;
  white-space: nowrap;
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.btn i {
  font-size: 14px;
}

.btn-primary {
  background: var(--gradient-primary);
  color: white;
  box-shadow: var(--shadow-md);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.btn-secondary {
  background: var(--gradient-secondary);
  color: white;
  box-shadow: var(--shadow-md);
}

.btn-secondary:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.btn-outline {
  background: transparent;
  color: var(--primary);
  border: 2px solid var(--primary);
}

.btn-outline:hover {
  background: var(--primary);
  color: white;
}

.btn-sm {
  padding: 8px 16px;
  font-size: 14px;
}

.btn-icon {
  width: 40px;
  height: 40px;
  padding: 0;
  border-radius: var(--radius-round);
}

/* 改进的下拉列表样式 */
.form-control {
  padding: 12px 16px;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  font-size: 16px;
  transition: all var(--transition-fast);
  background-color: var(--card-bg);
  color: var(--text-color);
}

.form-control:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(var(--primary-rgb, 16, 185, 129), 0.1);
}

/* 自定义下拉箭头 */
select.form-control {
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%236c757d' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  background-size: 16px;
  padding-right: 40px;
  cursor: pointer;
}

/* 下拉列表悬停状态 */
select.form-control:hover {
  border-color: var(--gray-400);
}

/* 主内容区域 */
.main-content {
  margin-top: 80px;
  padding: 40px 0;
  min-height: calc(100vh - 200px);
}

/* 隐藏非激活页面 */
.page {
  display: none;
  opacity: 0;
}

.page.active {
  display: block;
  animation: pageTransitionIn 0.4s ease-out forwards;
}

/* 英雄区域 */
.hero {
  padding: 80px 0;
  background: linear-gradient(135deg, rgba(var(--primary-rgb, 16, 185, 129), 0.05) 0%, rgba(var(--primary-dark-rgb, 13, 150, 104), 0.05) 100%);
  border-radius: var(--radius-xl);
  margin-bottom: 60px;
  text-align: center;
  position: relative;
  overflow: hidden;
  transition: all var(--transition-fast);
}

.hero::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,100 Z" fill="rgba(var(--primary-rgb, 16, 185, 129), 0.03)"/></svg>');
  background-size: cover;
}

.hero-title {
  font-size: 48px;
  margin-bottom: 20px;
  background: var(--gradient-primary);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  transition: all var(--transition-fast);
}

.hero-subtitle {
  font-size: 20px;
  color: var(--gray-600);
  max-width: 700px;
  margin: 0 auto 40px;
  line-height: 1.6;
}

/* 统计卡片 */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 24px;
  margin-bottom: 60px;
}

.stat-card {
  background: var(--card-bg);
  border-radius: var(--radius-lg);
  padding: 30px;
  box-shadow: var(--shadow-md);
  transition: all var(--transition-normal);
  position: relative;
  overflow: hidden;
}

.stat-card:hover {
  transform: translateY(-5px);
  box-shadow: var(--shadow-xl);
}

.stat-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 6px;
  height: 100%;
  background: var(--gradient-primary);
  transition: all var(--transition-fast);
}

.stat-icon {
  width: 60px;
  height: 60px;
  background: var(--gradient-primary);
  border-radius: var(--radius-md);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 24px;
  margin-bottom: 20px;
  transition: all var(--transition-fast);
}

.stat-value {
  font-size: 36px;
  font-weight: 800;
  color: var(--gray-900);
  margin-bottom: 8px;
}

.stat-label {
  font-size: 16px;
  color: var(--gray-600);
  font-weight: 500;
}

/* 表格样式 */
.table-container {
  background: var(--card-bg);
  border-radius: var(--radius-lg);
  overflow: hidden;
  box-shadow: var(--shadow-md);
  margin-bottom: 40px;
}

.table-header {
  padding: 24px;
  border-bottom: 1px solid var(--border-color);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.table-title {
  font-size: 20px;
  font-weight: 700;
  color: var(--gray-900);
}

.papers-table {
  width: 100%;
  border-collapse: collapse;
}

.papers-table th {
  padding: 16px 24px;
  text-align: left;
  background: var(--gray-100);
  color: var(--gray-700);
  font-weight: 600;
  font-size: 14px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border-bottom: 1px solid var(--border-color);
}

.papers-table td {
  padding: 20px 24px;
  border-bottom: 1px solid var(--border-color);
  vertical-align: middle;
}

.papers-table tr:last-child td {
  border-bottom: none;
}

.papers-table tr:hover {
  background-color: rgba(var(--primary-rgb, 16, 185, 129), 0.03);
  transition: background-color var(--transition-fast);
}

/* 操作按钮容器 */
.action-buttons {
  display: flex;
  gap: 8px;
}

/* 搜索区域 */
.search-section {
  background: var(--card-bg);
  border-radius: var(--radius-lg);
  padding: 30px;
  box-shadow: var(--shadow-md);
  margin-bottom: 40px;
}

.search-title {
  font-size: 24px;
  margin-bottom: 24px;
  color: var(--gray-900);
}

.search-form {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin-bottom: 30px;
}

.form-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.form-label {
  font-weight: 600;
  color: var(--gray-700);
  font-size: 14px;
}

.search-results {
  margin-top: 40px;
}

/* 模态框 */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(5px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2000;
  opacity: 0;
  visibility: hidden;
  transition: all var(--transition-normal);
}

.modal.show {
  opacity: 1;
  visibility: visible;
}

.modal-content {
  background: var(--card-bg);
  border-radius: var(--radius-lg);
  width: 90%;
  max-width: 500px;
  max-height: 90vh;
  overflow-y: auto;
  transform: translateY(20px);
  transition: transform var(--transition-normal);
}

.modal.show .modal-content {
  transform: translateY(0);
}

.modal-header {
  padding: 24px;
  border-bottom: 1px solid var(--border-color);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-title {
  font-size: 24px;
  font-weight: 700;
  color: var(--gray-900);
}

.modal-close {
  background: none;
  border: none;
  font-size: 24px;
  color: var(--gray-500);
  cursor: pointer;
  transition: color var(--transition-fast);
}

.modal-close:hover {
  color: var(--danger);
}

.modal-body {
  padding: 24px;
}

.modal-footer {
  padding: 20px 24px;
  border-top: 1px solid var(--border-color);
  display: flex;
  justify-content: flex-end;
  gap: 12px;
}

/* 警告框 */
.alert {
  padding: 16px 20px;
  border-radius: var(--radius-md);
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 12px;
  transition: all var(--transition-fast);
  position: relative;
}

.alert-success {
  background: rgba(var(--success-rgb, 16, 185, 129), 0.1);
  color: var(--success);
  border-left: 4px solid var(--success);
}

.alert-error {
  background: rgba(var(--danger-rgb, 239, 68, 68), 0.1);
  color: var(--danger);
  border-left: 4px solid var(--danger);
}

.alert-info {
  background: rgba(var(--primary-rgb, 16, 185, 129), 0.1);
  color: var(--primary);
  border-left: 4px solid var(--primary);
}

.alert-warning {
  background: rgba(var(--warning-rgb, 245, 158, 11), 0.1);
  color: var(--warning);
  border-left: 4px solid var(--warning);
}

.alert-close {
  position: absolute;
  right: 10px;
  top: 10px;
  background: none;
  border: none;
  color: inherit;
  cursor: pointer;
  font-size: 14px;
}

/* 页脚 */
.footer {
  background: var(--footer-bg);
  color: white;
  padding: 60px 0 30px;
  margin-top: 80px;
}

.footer-content {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 40px;
  margin-bottom: 40px;
}

.footer-section-title {
  font-size: 18px;
  font-weight: 700;
  margin-bottom: 20px;
  color: white;
}

.footer-links {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.footer-link {
  color: var(--gray-300);
  transition: color var(--transition-fast);
  cursor: pointer;
  display: inline-block;
}

.footer-link:hover {
  color: white;
}

.footer-bottom {
  text-align: center;
  padding-top: 30px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  color: var(--gray-400);
  font-size: 14px;
}

/* 空状态 */
.empty-state {
  text-align: center;
  padding: 60px 20px;
}

.empty-state-icon {
  font-size: 64px;
  color: var(--gray-300);
  margin-bottom: 20px;
}

.empty-state-title {
  font-size: 24px;
  color: var(--gray-700);
  margin-bottom: 12px;
}

.empty-state-description {
  color: var(--gray-600);
  max-width: 400px;
  margin: 0 auto 30px;
}

/* 联考试卷展开样式 */
.exam-row {
  cursor: pointer;
  transition: all var(--transition-fast);
}

.exam-row:hover {
  background-color: rgba(var(--primary-rgb, 16, 185, 129), 0.05) !important;
}

.exam-details {
  background: var(--gray-100);
  transition: all var(--transition-fast);
}

.exam-details-content {
  padding: 20px;
}

.exam-subject {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  margin-bottom: 8px;
  background: var(--card-bg);
  border-radius: var(--radius-md);
  border: 1px solid var(--border-color);
  transition: all var(--transition-fast);
}

.exam-subject:hover {
  transform: translateX(5px);
  box-shadow: var(--shadow-sm);
}

.exam-subject-name {
  font-weight: 600;
}

.exam-subject-date {
  color: var(--gray-600);
  font-size: 14px;
}

/* 图片展示框 */
.image-showcase {
  margin: 40px 0;
  text-align: center;
}

.image-box {
  background: var(--card-bg);
  border-radius: var(--radius-lg);
  padding: 30px;
  box-shadow: var(--shadow-md);
  transition: all var(--transition-fast);
}

.image-box:hover {
  transform: translateY(-5px);
  box-shadow: var(--shadow-xl);
}

.image-box img {
  max-width: 100%;
  height: auto;
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-lg);
}

.image-box-title {
  font-size: 20px;
  margin-bottom: 20px;
  color: var(--gray-900);
}

/* 数据源指示器 */
.data-source-info {
  background: rgba(var(--primary-rgb, 16, 185, 129), 0.05);
  border: 1px solid rgba(var(--primary-rgb, 16, 185, 129), 0.2);
  border-radius: var(--radius-md);
  padding: 12px 16px;
  margin-top: 20px;
  font-size: 14px;
  color: var(--gray-600);
  transition: all var(--transition-fast);
}

.data-source-info i {
  color: var(--primary);
  margin-right: 8px;
}

/* 响应式设计 */
@media (max-width: 768px) {
  .navbar-container {
    flex-direction: column;
    gap: 20px;
  }
  
  .nav-links {
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
  }
  
  .theme-controls {
    margin-left: 0;
    margin-top: 10px;
  }
  
  .color-picker-menu {
    width: 280px;
    right: -50px;
  }
  
  .hero-title {
    font-size: 36px;
  }
  
  .hero-subtitle {
    font-size: 18px;
  }
  
  .table-header {
    flex-direction: column;
    gap: 20px;
    align-items: flex-start;
  }
  
  .search-form {
    grid-template-columns: 1fr;
  }
  
  .action-buttons {
    flex-direction: column;
    width: 100%;
  }
  
  .action-buttons .btn {
    width: 100%;
    margin-bottom: 5px;
  }
}

/* 工具类 */
.d-none {
  display: none !important;
}

.d-flex {
  display: flex !important;
}

.justify-between {
  justify-content: space-between;
}

.align-center {
  align-items: center;
}

.text-center {
  text-align: center;
}

.mb-20 {
  margin-bottom: 20px;
}

.mb-40 {
  margin-bottom: 40px;
}

.mt-20 {
  margin-top: 20px;
}

.mt-40 {
  margin-top: 40px;
}

.w-100 {
  width: 100%;
}

.gap-10 {
  gap: 10px;
}

.gap-15 {
  gap: 15px;
}

.gap-20 {
  gap: 20px;
}

.justify-center {
  justify-content: center;
}

/* 加载指示器 */
.loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px;
}

.loading-spinner {
  width: 40px;
  height: 40px;
  border: 3px solid var(--gray-200);
  border-top-color: var(--primary);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 16px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.loading-text {
  color: var(--gray-600);
  font-size: 16px;
}

/* 导航动效类 */
.nav-slide-left::after {
  animation: navLinkSlideInLeft 0.3s ease-out;
}

.nav-slide-right::after {
  animation: navLinkSlideInRight 0.3s ease-out;
}
</style>
</head>
<body>
<!-- 提示框容器 -->
<div class="toast-container" id="toast-container"></div>

<!-- 顶部导航栏 -->
<nav class="navbar">
  <div class="container navbar-container">
    <div class="navbar-brand">
      <div class="logo animate-pulse">F</div>
      <div class="logo-text">FPaper 试卷库</div>
    </div>
    <div class="d-flex align-center">
      <ul class="nav-links">
        <li><a href="#" class="nav-link active" data-page="home">首页</a></li>
        <li><a href="#" class="nav-link" data-page="papers">试卷库</a></li>
        <li><a href="#" class="nav-link" data-page="about">关于</a></li>
      </ul>
      <div class="theme-controls">
        <button class="theme-btn color-picker-btn" id="color-picker-btn" title="自定义颜色">
          <i class="fas fa-palette"></i>
        </button>
        <div class="color-picker-menu" id="color-picker-menu">
          <div class="color-picker-tabs">
            <div class="color-tab active" data-tab="preset">预设颜色</div>
            <div class="color-tab" data-tab="custom">自定义颜色</div>
          </div>
          <div class="color-tab-content" id="preset-colors">
            <div class="color-grid">
              <div class="color-option active" data-color="green"></div>
              <div class="color-option" data-color="blue"></div>
              <div class="color-option" data-color="purple"></div>
              <div class="color-option" data-color="red"></div>
              <div class="color-option" data-color="orange"></div>
              <div class="color-option" data-color="teal"></div>
              <div class="color-option" data-color="pink"></div>
              <div class="color-option" data-color="indigo"></div>
              <div class="color-option" data-color="cyan"></div>
              <div class="color-option" data-color="lime"></div>
              <div class="color-option" data-color="amber"></div>
              <div class="color-option" data-color="rose"></div>
              <div class="color-option" data-color="violet"></div>
              <div class="color-option" data-color="emerald"></div>
              <div class="color-option" data-color="sky"></div>
              <div class="color-option" data-color="fuchsia"></div>
              <div class="color-option" data-color="yellow"></div>
              <div class="color-option" data-color="stone"></div>
              <div class="color-option" data-color="neutral"></div>
              <div class="color-option" data-color="zinc"></div>
            </div>
          </div>
          <div class="color-tab-content d-none" id="custom-colors">
            <div class="color-preview" id="color-preview"></div>
            <div class="rgb-inputs">
              <div class="rgb-input">
                <label for="rgb-r">R</label>
                <input type="number" id="rgb-r" min="0" max="255" value="16">
              </div>
              <div class="rgb-input">
                <label for="rgb-g">G</label>
                <input type="number" id="rgb-g" min="0" max="255" value="185">
              </div>
              <div class="rgb-input">
                <label for="rgb-b">B</label>
                <input type="number" id="rgb-b" min="0" max="255" value="129">
              </div>
            </div>
          </div>
          <button class="apply-color-btn" id="apply-color-btn">
            <i class="fas fa-check"></i>
            应用颜色
          </button>
        </div>
        <button class="theme-btn" id="theme-toggle-btn" title="切换日间/夜间模式">
          <i class="fas fa-moon"></i>
        </button>
      </div>
    </div>
  </div>
</nav>

<!-- 主内容区域 -->
<main class="main-content">
  <div class="container">
    <!-- 首页 -->
    <div id="home-page" class="page active">
      <div class="hero animate-fade-in">
        <h1 class="hero-title">高考真题与模拟题资源库</h1>
        <p class="hero-subtitle">收集中国历年高考真题和各地市模拟题，提供高质量的学习资源，助力高考备考和教学研究</p>
        <div class="d-flex justify-center align-center gap-20">
          <button class="btn btn-primary animate-float" data-page="papers">
            <i class="fas fa-book-open"></i>
            浏览试卷
          </button>
        </div>
      </div>
      <div id="stats-container">
        <div class="stats-grid">
          <div class="stat-card animate-slide-left">
            <div class="stat-icon">
              <i class="fas fa-file-alt"></i>
            </div>
            <div class="stat-value" id="total-papers">0</div>
            <div class="stat-label">总试卷数量</div>
          </div>
          <div class="stat-card animate-fade-in">
            <div class="stat-icon">
              <i class="fas fa-calendar-alt"></i>
            </div>
            <div class="stat-value" id="total-years">0</div>
            <div class="stat-label">年份跨度</div>
          </div>
          <div class="stat-card animate-fade-in">
            <div class="stat-icon">
              <i class="fas fa-tags"></i>
            </div>
            <div class="stat-value" id="total-categories">0</div>
            <div class="stat-label">分类数量</div>
          </div>
          <div class="stat-card animate-slide-right">
            <div class="stat-icon">
              <i class="fas fa-calendar-alt"></i>
            </div>
            <div class="stat-value" id="latest-year">2025</div>
            <div class="stat-label">最新年份</div>
          </div>
        </div>
      </div>
      <div class="table-container">
        <div class="table-header">
          <h2 class="table-title">最新联考</h2>
          <a href="#" class="btn btn-outline btn-sm" data-page="papers">
            查看全部
            <i class="fas fa-arrow-right"></i>
          </a>
        </div>
        <div id="recent-papers-table">
          <div class="loading">
            <div class="loading-spinner"></div>
            <div class="loading-text">正在加载试卷数据...</div>
          </div>
        </div>
      </div>
    </div>

    <!-- 试卷库页面 -->
    <div id="papers-page" class="page">
      <div class="search-section">
        <h2 class="search-title">试卷库</h2>
        <div class="search-form">
          <div class="form-group">
            <label class="form-label">搜索关键词</label>
            <input type="text" class="form-control" id="paper-search" placeholder="联考名称、试卷名称或关键词">
          </div>
          <div class="form-group">
            <label class="form-label">科目分类</label>
            <select class="form-control" id="paper-category">
              <option value="">所有科目</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">年份</label>
            <select class="form-control" id="paper-year">
              <option value="">所有年份</option>
            </select>
          </div>
        </div>
        <div class="d-flex justify-between align-center">
          <button class="btn btn-primary" id="search-papers-btn">
            <i class="fas fa-search"></i>
            搜索
          </button>
          <button class="btn btn-outline" id="reset-search-btn">
            <i class="fas fa-redo"></i>
            重置
          </button>
        </div>
        <div id="data-source-info" class="data-source-info d-none">
          <i class="fas fa-database"></i>
          <span>数据源：data.txt + category.txt文件 | 共加载了<span id="loaded-exams-count">0</span>个联考，<span id="loaded-papers-count">0</span>份试卷</span>
        </div>
      </div>
      <div class="table-container">
        <table class="papers-table" id="papers-table">
          <thead>
            <tr>
              <th>联考名称</th>
              <th>包含科目</th>
              <th>最新日期</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody id="papers-table-body">
            <tr>
              <td colspan="4" style="text-align: center; padding: 40px;">
                <div class="loading">
                  <div class="loading-spinner"></div>
                  <div class="loading-text">正在加载试卷数据...</div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- 关于页面 -->
    <div id="about-page" class="page">
      <div class="hero">
        <h1 class="hero-title">关于 FPaper 试卷库</h1>
        <p class="hero-subtitle">一个致力于高考教育资源整合的开源项目</p>
      </div>
      <div class="search-section mb-40">
        <h2 class="search-title">项目简介</h2>
        <p style="color: var(--gray-600); line-height: 1.8; margin-bottom: 20px;">
          FPaper 试卷库是一个专注于收集、整理和管理中国历年高考真题及各地市模拟题的开源平台。我们的使命是为高考学生、教师和研究人员提供高质量、系统化的备考资源，助力高考备考和教学研究的进步。
        </p>
        <p style="color: var(--gray-600); line-height: 1.8;">
          平台采用现代化的Web技术构建，具有响应式设计、直观的用户界面和强大的搜索功能。所有数据来源于公开资源，持续更新维护。
        </p>
      </div>
      
      <!-- 图片展示框 -->
      <div class="image-showcase">
        <div class="image-box">
          <h3 class="image-box-title">平台截图</h3>
          <div id="platform-image-container">
            <img src="image.png" alt="FPaper 平台截图" onerror="this.style.display='none'; document.getElementById('image-error').style.display='block';">
            <div id="image-error" style="display: none; padding: 40px; color: var(--gray-500); text-align: center;">
              <i class="fas fa-image" style="font-size: 48px; margin-bottom: 20px;"></i>
              <p>图片加载失败，请确保 image.png 文件存在于当前目录</p>
            </div>
          </div>
        </div>
      </div>
      
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon">
            <i class="fas fa-code-branch"></i>
          </div>
          <div class="stat-value">开源</div>
          <div class="stat-label">完全开源项目</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">
            <i class="fas fa-users"></i>
          </div>
          <div class="stat-value">社区驱动</div>
          <div class="stat-label">由社区共同维护</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">
            <i class="fas fa-graduation-cap"></i>
          </div>
          <div class="stat-value">教育公益</div>
          <div class="stat-label">专注于教育公益</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">
            <i class="fas fa-sync-alt"></i>
          </div>
          <div class="stat-value">持续更新</div>
          <div class="stat-label">定期更新和维护</div>
        </div>
      </div>
      <div class="search-section mt-40">
        <h2 class="search-title">主题功能说明</h2>
        <div class="alert alert-info">
          <i class="fas fa-palette"></i>
          <span><strong>颜色自定义功能：</strong>点击顶部导航栏的调色板图标，可以选择20种预设颜色或自定义RGB颜色。此功能在日间和夜间模式下均可使用。</span>
        </div>
        <div class="alert alert-warning mt-20">
          <i class="fas fa-moon"></i>
          <span><strong>日夜模式切换：</strong>点击月亮图标可以在日间模式和夜间模式之间切换。夜间模式使用专门优化的深色配色方案，保护视力并提供更好的阅读体验。</span>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- 页脚 -->
<footer class="footer">
  <div class="container">
    <div class="footer-content">
      <div>
        <h3 class="footer-section-title">FPaper 试卷库</h3>
        <p style="color: var(--gray-300); margin-bottom: 20px;">
          高考真题与模拟题资源库，为高考备考提供高质量的学习资源。
        </p>
        <div class="d-flex gap-15">
          <a href="#" class="footer-link">
            <i class="fab fa-github"></i>
          </a>
          <a href="#" class="footer-link">
            <i class="fab fa-weixin"></i>
          </a>
          <a href="#" class="footer-link">
            <i class="fab fa-qq"></i>
          </a>
        </div>
      </div>
      <div>
        <h3 class="footer-section-title">快速链接</h3>
        <ul class="footer-links">
          <li><a href="#" class="footer-link" data-page="home">首页</a></li>
          <li><a href="#" class="footer-link" data-page="papers">试卷库</a></li>
          <li><a href="#" class="footer-link" data-page="about">关于</a></li>
        </ul>
      </div>
      <div>
        <h3 class="footer-section-title">科目分类</h3>
        <ul class="footer-links" id="footer-categories">
          <!-- 动态加载 -->
        </ul>
      </div>
      <div>
        <h3 class="footer-section-title">联系我们</h3>
        <ul class="footer-links">
          <li><a href="mailto:contact@fpaper.org" class="footer-link">contact@fpaper.org</a></li>
          <li><a href="#" class="footer-link">贡献指南</a></li>
          <li><a href="#" class="footer-link">使用说明</a></li>
          <li><a href="#" class="footer-link">更新日志</a></li>
        </ul>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2024 FPaper 试卷库. 保留所有权利。 | 一个开源高考教育项目</p>
    </div>
  </div>
</footer>

<!-- 下载确认模态框 -->
<div id="download-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">确认下载</h3>
      <button class="modal-close" id="close-download-modal">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="modal-body">
      <p>您即将下载试卷：<strong id="download-paper-name"></strong></p>
      <div class="alert alert-info mt-20">
        <i class="fas fa-info-circle"></i>
        <span>请注意：部分试卷链接可能指向外部网站，请确保您信任该来源。</span>
      </div>
      <div class="mt-20" style="font-size: 14px; color: var(--gray-600);">
        <p>下载链接：</p>
        <code id="download-paper-url" style="display: block; padding: 10px; background: var(--gray-100); border-radius: var(--radius-md); margin-top: 5px; word-break: break-all;"></code>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" id="cancel-download">取消</button>
      <a href="#" target="_blank" class="btn btn-primary" id="confirm-download-link">确认下载</a>
    </div>
  </div>
</div>

<!-- 试卷详情模态框 -->
<div id="paper-details-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title" id="paper-details-title">试卷详情</h3>
      <button class="modal-close" id="close-paper-details">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="modal-body" id="paper-details-content">
      <!-- 动态加载 -->
    </div>
    <div class="modal-footer">
      <button class="btn btn-outline" id="close-details-modal">关闭</button>
      <a href="#" target="_blank" class="btn btn-primary" id="paper-download-btn">下载试卷</a>
    </div>
  </div>
</div>

<script>
// 颜色主题配置 - 20种颜色
const COLOR_THEMES = {
  green: {
    primary: '#10b981',
    primaryDark: '#0ea271',
    gradientPrimary: 'linear-gradient(135deg, #10b981 0%, #0d9668 100%)'
  },
  blue: {
    primary: '#3b82f6',
    primaryDark: '#2563eb',
    gradientPrimary: 'linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)'
  },
  purple: {
    primary: '#8b5cf6',
    primaryDark: '#7c3aed',
    gradientPrimary: 'linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)'
  },
  red: {
    primary: '#ef4444',
    primaryDark: '#dc2626',
    gradientPrimary: 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)'
  },
  orange: {
    primary: '#f59e0b',
    primaryDark: '#d97706',
    gradientPrimary: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)'
  },
  teal: {
    primary: '#14b8a6',
    primaryDark: '#0d9488',
    gradientPrimary: 'linear-gradient(135deg, #14b8a6 0%, #0d9488 100%)'
  },
  pink: {
    primary: '#ec4899',
    primaryDark: '#db2777',
    gradientPrimary: 'linear-gradient(135deg, #ec4899 0%, #db2777 100%)'
  },
  indigo: {
    primary: '#6366f1',
    primaryDark: '#4f46e5',
    gradientPrimary: 'linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)'
  },
  cyan: {
    primary: '#06b6d4',
    primaryDark: '#0891b2',
    gradientPrimary: 'linear-gradient(135deg, #06b6d4 0%, #0891b2 100%)'
  },
  lime: {
    primary: '#84cc16',
    primaryDark: '#65a30d',
    gradientPrimary: 'linear-gradient(135deg, #84cc16 0%, #65a30d 100%)'
  },
  amber: {
    primary: '#fbbf24',
    primaryDark: '#f59e0b',
    gradientPrimary: 'linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)'
  },
  rose: {
    primary: '#f43f5e',
    primaryDark: '#e11d48',
    gradientPrimary: 'linear-gradient(135deg, #f43f5e 0%, #e11d48 100%)'
  },
  violet: {
    primary: '#a855f7',
    primaryDark: '#9333ea',
    gradientPrimary: 'linear-gradient(135deg, #a855f7 0%, #9333ea 100%)'
  },
  emerald: {
    primary: '#10b981',
    primaryDark: '#059669',
    gradientPrimary: 'linear-gradient(135deg, #10b981 0%, #059669 100%)'
  },
  sky: {
    primary: '#0ea5e9',
    primaryDark: '#0284c7',
    gradientPrimary: 'linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%)'
  },
  fuchsia: {
    primary: '#d946ef',
    primaryDark: '#c026d3',
    gradientPrimary: 'linear-gradient(135deg, #d946ef 0%, #c026d3 100%)'
  },
  yellow: {
    primary: '#eab308',
    primaryDark: '#ca8a04',
    gradientPrimary: 'linear-gradient(135deg, #eab308 0%, #ca8a04 100%)'
  },
  stone: {
    primary: '#78716c',
    primaryDark: '#57534e',
    gradientPrimary: 'linear-gradient(135deg, #78716c 0%, #57534e 100%)'
  },
  neutral: {
    primary: '#737373',
    primaryDark: '#525252',
    gradientPrimary: 'linear-gradient(135deg, #737373 0%, #525252 100%)'
  },
  zinc: {
    primary: '#71717a',
    primaryDark: '#52525b',
    gradientPrimary: 'linear-gradient(135deg, #71717a 0%, #52525b 100%)'
  }
};

// 应用程序状态管理
const FPAPER = {
  // 状态变量
  state: {
    exams: [], // 联考数组
    categories: new Map(),
    currentPage: 'home',
    selectedPaperId: null,
    isLoading: true,
    dataSource: 'none',
    currentTheme: 'light',
    currentColor: 'green',
    toastCounter: 0,
    expandedExams: new Set(), // 展开的联考ID
    navHistory: ['home'] // 导航历史，用于判断方向
  },
  
  // 初始化应用程序
  async init() {
    this.loadThemeSettings();
    this.initThemeControls();
    this.initEventListeners();
    await this.loadCategories();
    await this.loadExams();
  },
  
  // 加载主题设置
  loadThemeSettings() {
    const savedTheme = localStorage.getItem('fpaper-theme');
    const savedColor = localStorage.getItem('fpaper-color');
    const savedCustomColor = localStorage.getItem('fpaper-custom-color');
    
    if (savedTheme) {
      this.state.currentTheme = savedTheme;
      document.documentElement.setAttribute('data-theme', savedTheme);
    }
    
    if (savedColor) {
      this.state.currentColor = savedColor;
      this.applyColorTheme(savedColor);
    }
    
    if (savedCustomColor) {
      this.applyCustomColor(savedCustomColor, false);
    }
    
    this.updateThemeButtonIcon();
  },
  
  // 初始化主题控制
  initThemeControls() {
    const colorPickerBtn = document.getElementById('color-picker-btn');
    const colorPickerMenu = document.getElementById('color-picker-menu');
    
    colorPickerBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      colorPickerMenu.classList.toggle('show');
      
      // 初始化自定义颜色预览
      if (!this.initCustomColorPreview) {
        this.initCustomColorPreview = true;
        this.initRGBInputs();
      }
    });
    
    // 颜色选择标签切换
    document.querySelectorAll('.color-tab').forEach(tab => {
      tab.addEventListener('click', (e) => {
        document.querySelectorAll('.color-tab').forEach(t => t.classList.remove('active'));
        e.target.classList.add('active');
        
        const tabName = e.target.getAttribute('data-tab');
        document.querySelectorAll('.color-tab-content').forEach(content => {
          content.classList.add('d-none');
        });
        document.getElementById(tabName + '-colors').classList.remove('d-none');
      });
    });
    
    // 预设颜色选择
    document.querySelectorAll('.color-option').forEach(option => {
      option.addEventListener('click', (e) => {
        const color = e.target.getAttribute('data-color');
        document.querySelectorAll('.color-option').forEach(opt => {
          opt.classList.remove('active');
        });
        e.target.classList.add('active');
        this.state.currentColor = color;
        this.updateColorPreview();
      });
    });
    
    // RGB输入变化
    document.getElementById('rgb-r').addEventListener('input', () => this.updateColorPreview());
    document.getElementById('rgb-g').addEventListener('input', () => this.updateColorPreview());
    document.getElementById('rgb-b').addEventListener('input', () => this.updateColorPreview());
    
    // 应用颜色按钮
    document.getElementById('apply-color-btn').addEventListener('click', () => {
      const activeTab = document.querySelector('.color-tab.active').getAttribute('data-tab');
      
      if (activeTab === 'preset') {
        const selectedColor = document.querySelector('.color-option.active').getAttribute('data-color');
        this.changeColorTheme(selectedColor);
      } else {
        const r = document.getElementById('rgb-r').value;
        const g = document.getElementById('rgb-g').value;
        const b = document.getElementById('rgb-b').value;
        this.applyCustomColor(`rgb(${r}, ${g}, ${b})`, true);
      }
      
      colorPickerMenu.classList.remove('show');
    });
    
    document.addEventListener('click', (e) => {
      if (!colorPickerBtn.contains(e.target) && !colorPickerMenu.contains(e.target)) {
        colorPickerMenu.classList.remove('show');
      }
    });
    
    const themeToggleBtn = document.getElementById('theme-toggle-btn');
    themeToggleBtn.addEventListener('click', () => {
      this.toggleTheme();
    });
  },
  
  // 初始化RGB输入
  initRGBInputs() {
    const savedCustomColor = localStorage.getItem('fpaper-custom-color');
    if (savedCustomColor) {
      const rgbMatch = savedCustomColor.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);
      if (rgbMatch) {
        document.getElementById('rgb-r').value = rgbMatch[1];
        document.getElementById('rgb-g').value = rgbMatch[2];
        document.getElementById('rgb-b').value = rgbMatch[3];
      }
    }
    this.updateColorPreview();
  },
  
  // 更新颜色预览
  updateColorPreview() {
    const preview = document.getElementById('color-preview');
    const activeTab = document.querySelector('.color-tab.active').getAttribute('data-tab');
    
    if (activeTab === 'preset') {
      const selectedColor = document.querySelector('.color-option.active').getAttribute('data-color');
      const theme = COLOR_THEMES[selectedColor];
      if (theme) {
        preview.style.background = theme.gradientPrimary;
      }
    } else {
      const r = document.getElementById('rgb-r').value;
      const g = document.getElementById('rgb-g').value;
      const b = document.getElementById('rgb-b').value;
      preview.style.background = `rgb(${r}, ${g}, ${b})`;
    }
  },
  
  // 切换日间/夜间模式
  toggleTheme() {
    const newTheme = this.state.currentTheme === 'light' ? 'dark' : 'light';
    this.state.currentTheme = newTheme;
    
    document.documentElement.setAttribute('data-theme', newTheme);
    localStorage.setItem('fpaper-theme', newTheme);
    
    this.updateThemeButtonIcon();
    
    // 应用保存的颜色主题
    this.applySavedColorTheme();
    
    this.showToast(`已切换到${newTheme === 'light' ? '日间' : '夜间'}模式`, 'success');
  },
  
  // 应用保存的颜色主题
  applySavedColorTheme() {
    const savedColor = localStorage.getItem('fpaper-color');
    const savedCustomColor = localStorage.getItem('fpaper-custom-color');
    
    if (savedCustomColor) {
      this.applyCustomColor(savedCustomColor, false);
    } else if (savedColor) {
      this.applyColorTheme(savedColor);
    }
  },
  
  // 更新主题按钮图标
  updateThemeButtonIcon() {
    const themeToggleBtn = document.getElementById('theme-toggle-btn');
    const icon = themeToggleBtn.querySelector('i');
    
    if (this.state.currentTheme === 'light') {
      icon.className = 'fas fa-moon';
      themeToggleBtn.title = '切换到夜间模式';
    } else {
      icon.className = 'fas fa-sun';
      themeToggleBtn.title = '切换到日间模式';
    }
  },
  
  // 更改颜色主题
  changeColorTheme(color) {
    this.state.currentColor = color;
    this.applyColorTheme(color);
    
    localStorage.setItem('fpaper-color', color);
    localStorage.removeItem('fpaper-custom-color');
    
    this.showToast(`已切换到${this.getColorName(color)}主题`, 'success');
  },
  
  // 应用颜色主题
  applyColorTheme(color) {
    const theme = COLOR_THEMES[color];
    if (!theme) return;
    
    this.applyCustomColor(theme.primary, false, color);
  },
  
  // 应用自定义颜色
  applyCustomColor(color, showToast = true, colorName = null) {
    const root = document.documentElement;
    
    // 提取RGB值
    const rgbMatch = color.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);
    let r = 16, g = 185, b = 129;
    
    if (rgbMatch) {
      r = parseInt(rgbMatch[1]);
      g = parseInt(rgbMatch[2]);
      b = parseInt(rgbMatch[3]);
    } else if (color.startsWith('#')) {
      // 如果是十六进制颜色
      const hex = color.replace('#', '');
      r = parseInt(hex.substr(0, 2), 16);
      g = parseInt(hex.substr(2, 2), 16);
      b = parseInt(hex.substr(4, 2), 16);
    }
    
    // 计算暗色版本
    const darken = (value, factor = 0.8) => Math.max(0, Math.floor(value * factor));
    const rDark = darken(r);
    const gDark = darken(g);
    const bDark = darken(b);
    
    // 设置CSS变量
    root.style.setProperty('--primary', `rgb(${r}, ${g}, ${b})`);
    root.style.setProperty('--primary-dark', `rgb(${rDark}, ${gDark}, ${bDark})`);
    root.style.setProperty('--primary-rgb', `${r}, ${g}, ${b}`);
    root.style.setProperty('--primary-dark-rgb', `${rDark}, ${gDark}, ${bDark}`);
    root.style.setProperty('--gradient-primary', `linear-gradient(135deg, rgb(${r}, ${g}, ${b}) 0%, rgb(${rDark}, ${gDark}, ${bDark}) 100%)`);
    
    // 设置成功和警告颜色的RGB值
    root.style.setProperty('--success-rgb', `${r}, ${g}, ${b}`);
    root.style.setProperty('--warning-rgb', '245, 158, 11');
    root.style.setProperty('--danger-rgb', '239, 68, 68');
    
    // 添加颜色切换动画
    document.body.classList.add('animate-color-change');
    setTimeout(() => {
      document.body.classList.remove('animate-color-change');
    }, 800);
    
    // 保存自定义颜色
    localStorage.setItem('fpaper-custom-color', `rgb(${r}, ${g}, ${b})`);
    
    if (showToast) {
      const toastMessage = colorName ? `已切换到${this.getColorName(colorName)}主题` : '已应用自定义颜色';
      this.showToast(toastMessage, 'success');
    }
  },
  
  // 获取颜色名称
  getColorName(color) {
    const names = {
      green: '清新绿',
      blue: '天空蓝',
      purple: '优雅紫',
      red: '热情红',
      orange: '活力橙',
      teal: '宁静青',
      pink: '浪漫粉',
      indigo: '深邃靛',
      cyan: '科技青',
      lime: '活力绿',
      amber: '琥珀黄',
      rose: '玫瑰红',
      violet: '紫罗兰',
      emerald: '翡翠绿',
      sky: '天空蓝',
      fuchsia: '洋红色',
      yellow: '阳光黄',
      stone: '岩石灰',
      neutral: '中性灰',
      zinc: '锌灰色'
    };
    return names[color] || color;
  },
  
  // 显示提示框
  showToast(message, type = 'info') {
    this.state.toastCounter++;
    const toastId = `toast-${this.state.toastCounter}`;
    
    const toast = document.createElement('div');
    toast.id = toastId;
    toast.className = `toast toast-${type}`;
    
    const iconClass = {
      success: 'fa-check-circle',
      error: 'fa-exclamation-circle',
      info: 'fa-info-circle',
      warning: 'fa-exclamation-triangle'
    }[type] || 'fa-info-circle';
    
    toast.innerHTML = `
      <div class="toast-content">
        <i class="fas ${iconClass} toast-icon"></i>
        <div class="toast-message">${message}</div>
        <button class="toast-close" data-toast-id="${toastId}">&times;</button>
      </div>
    `;
    
    const container = document.getElementById('toast-container');
    container.appendChild(toast);
    
    // 添加关闭事件
    toast.querySelector('.toast-close').addEventListener('click', (e) => {
      const id = e.target.getAttribute('data-toast-id');
      this.removeToast(id);
    });
    
    // 4秒后自动消失
    setTimeout(() => {
      this.removeToast(toastId);
    }, 4000);
  },
  
  // 移除提示框
  removeToast(toastId) {
    const toast = document.getElementById(toastId);
    if (!toast) return;
    
    toast.classList.add('fade-out');
    
    setTimeout(() => {
      if (toast.parentNode) {
        toast.remove();
      }
    }, 300);
  },
  
  // 加载分类数据
  async loadCategories() {
    try {
      const response = await fetch('/FPaperArchive/category.txt', {
        cache: 'no-cache',
        headers: {
          'Content-Type': 'text/plain; charset=utf-8'
        }
      });
      
      if (!response.ok) {
        throw new Error(`无法加载category.txt文件: HTTP ${response.status}`);
      }
      
      const text = await response.text();
      
      if (!text || text.trim() === '') {
        throw new Error('category.txt文件为空');
      }
      
      const categories = this.parseCategoriesData(text);
      this.state.categories = categories;
      
      console.log(`从category.txt文件加载了${categories.size}个分类`);
      
    } catch (error) {
      console.error('加载分类数据失败:', error);
      this.loadDefaultCategories();
    }
  },
  
  // 解析分类数据
  parseCategoriesData(text) {
    const categories = new Map();
    const lines = text.trim().split('\n');
    
    lines.forEach((line, index) => {
      const trimmedLine = line.trim();
      if (!trimmedLine) return;
      
      try {
        const dotIndex = trimmedLine.indexOf('.');
        if (dotIndex === -1) return;
        
        const id = parseInt(trimmedLine.substring(0, dotIndex).trim());
        const name = trimmedLine.substring(dotIndex + 1).trim();
        
        if (!isNaN(id) && name) {
          categories.set(id.toString(), name);
        }
      } catch (error) {
        console.warn(`解析分类第${index + 1}行失败: ${trimmedLine}`, error);
      }
    });
    
    return categories;
  },
  
  // 加载默认分类（备用）
  loadDefaultCategories() {
    const defaultCategories = new Map([
      ['1', '语文'],
      ['2', '数学'],
      ['3', '英语'],
      ['4', '物理'],
      ['5', '化学'],
      ['6', '技术'],
      ['7', '生物'],
      ['8', '地理'],
      ['9', '历史'],
      ['10', '政治']
    ]);
    
    this.state.categories = defaultCategories;
    console.log('使用默认分类数据');
  },
  
  // 加载联考数据
  async loadExams() {
    try {
      this.state.isLoading = true;
      this.showLoading();
      
      await this.loadExamsFromFile();
      
    } catch (error) {
      console.error('加载联考数据失败:', error);
      this.showError('无法加载data.txt文件，请确保文件存在且格式正确。');
    } finally {
      this.state.isLoading = false;
      this.initUI();
      this.showPage('home');
      this.updateStats();
      this.hideLoading();
      this.showDataSourceInfo();
      this.updateFooterCategories();
    }
  },
  
  // 从data.txt文件加载联考数据
  async loadExamsFromFile() {
    try {
      const response = await fetch('/FPaperArchive/data.txt', {
        cache: 'no-cache',
        headers: {
          'Content-Type': 'text/plain; charset=utf-8'
        }
      });
      
      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }
      
      const text = await response.text();
      
      if (!text || text.trim() === '') {
        throw new Error('data.txt文件为空');
      }
      
      const exams = this.parseExamsData(text);
      
      if (exams.length === 0) {
        throw new Error('data.txt文件中没有有效的联考数据');
      }
      
      this.state.exams = exams;
      this.state.dataSource = 'file';
      
      console.log(`从data.txt文件加载了${exams.length}个联考`);
      
    } catch (error) {
      console.error('从文件加载联考数据失败:', error);
      throw error;
    }
  },
  
  // 解析联考数据
  parseExamsData(text) {
    const exams = [];
    const lines = text.trim().split('\n');
    let examId = 1;
    
    lines.forEach((line, index) => {
      const trimmedLine = line.trim();
      if (!trimmedLine) return;
      
      try {
        // 解析格式：浙江强基联盟 [[语文-浙江强基联盟,2025.12.30,www.example.com/zhejiangqiangjilianmengyuwen,1],[数学-浙江强基联盟,2025.12.29,www.example.com/zhejiangqiangjilianmengshuxue,2]]
        const bracketStart = trimmedLine.indexOf('[');
        const bracketEnd = trimmedLine.lastIndexOf(']');
        
        if (bracketStart === -1 || bracketEnd === -1) return;
        
        const examName = trimmedLine.substring(0, bracketStart).trim();
        const papersData = trimmedLine.substring(bracketStart + 1, bracketEnd);
        
        // 解析试卷列表
        const papers = [];
        const paperMatches = papersData.match(/\[(.*?)\]/g);
        
        if (paperMatches) {
          paperMatches.forEach((paperStr, paperIndex) => {
            const cleanStr = paperStr.substring(1, paperStr.length - 1);
            const parts = cleanStr.split(',');
            
            if (parts.length >= 4) {
              const paperName = parts[0].trim();
              const dateStr = parts[1].trim();
              const url = parts[2].trim();
              const categoryId = parts[3].trim();
              
              const dateMatch = dateStr.match(/(\d{4})\.(\d{1,2})\.(\d{1,2})/);
              if (dateMatch) {
                const year = parseInt(dateMatch[1]);
                const month = parseInt(dateMatch[2]);
                const day = parseInt(dateMatch[3]);
                
                let categoryName = this.state.categories.get(categoryId);
                if (!categoryName) {
                  categoryName = '其他';
                }
                
                const formattedDate = `${year}年${month}月${day}日`;
                
                papers.push({
                  id: paperId++,
                  name: paperName,
                  year: year,
                  month: month,
                  day: day,
                  date: formattedDate,
                  fullDate: dateStr,
                  categoryId: categoryId,
                  category: categoryName,
                  url: url.startsWith('http') ? url : 'https://' + url,
                  description: `${paperName}，发布于${formattedDate}。这是一份${categoryName}试卷，适用于高考备考和教学研究。`
                });
              }
            }
          });
        }
        
        if (papers.length > 0) {
          // 计算联考的最新日期
          const latestPaper = papers.reduce((latest, paper) => {
            if (!latest) return paper;
            if (paper.year > latest.year) return paper;
            if (paper.year === latest.year && paper.month > latest.month) return paper;
            if (paper.year === latest.year && paper.month === latest.month && paper.day > latest.day) return paper;
            return latest;
          }, null);
          
          // 获取所有科目
          const subjects = [...new Set(papers.map(paper => paper.category))];
          
          exams.push({
            id: examId++,
            name: examName,
            papers: papers,
            latestDate: latestPaper ? latestPaper.fullDate : '',
            formattedDate: latestPaper ? latestPaper.date : '',
            year: latestPaper ? latestPaper.year : new Date().getFullYear(),
            subjects: subjects,
            subjectCount: papers.length,
            description: `${examName}共包含${papers.length}个科目的试卷，包括${subjects.join('、')}等科目。`
          });
        }
        
      } catch (error) {
        console.warn(`解析第${index + 1}行失败: ${trimmedLine}`, error);
      }
    });
    
    // 生成唯一的试卷ID
    let paperId = 1;
    exams.forEach(exam => {
      exam.papers.forEach(paper => {
        paper.id = paperId++;
        paper.examId = exam.id;
        paper.examName = exam.name;
      });
    });
    
    return exams;
  },
  
  // 更新页脚分类
  updateFooterCategories() {
    const footerCategories = document.getElementById('footer-categories');
    if (!footerCategories) return;
    
    footerCategories.innerHTML = '';
    
    let count = 0;
    this.state.categories.forEach((name, id) => {
      if (count < 6) {
        const li = document.createElement('li');
        li.innerHTML = `<a href="#" class="footer-link" data-category="${name}">${name}</a>`;
        footerCategories.appendChild(li);
        count++;
      }
    });
    
    this.bindFooterCategoryEvents();
  },
  
  // 绑定页脚分类事件
  bindFooterCategoryEvents() {
    document.querySelectorAll('#footer-categories .footer-link[data-category]').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const category = link.getAttribute('data-category');
        this.showPage('papers');
        document.getElementById('paper-category').value = category;
        this.searchPapers();
      });
    });
  },
  
  // 显示错误信息
  showError(message) {
    const homeTable = document.getElementById('recent-papers-table');
    if (homeTable) {
      homeTable.innerHTML = `
        <div class="empty-state">
          <div class="empty-state-icon">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
          <h3 class="empty-state-title">加载失败</h3>
          <p class="empty-state-description">${message}</p>
          <button class="btn btn-primary" onclick="FPAPER.loadExams()">
            <i class="fas fa-redo"></i>
            重新加载
          </button>
        </div>
      `;
    }
    
    const papersTable = document.getElementById('papers-table-body');
    if (papersTable) {
      papersTable.innerHTML = `
        <tr>
          <td colspan="4" style="text-align: center; padding: 40px;">
            <div class="empty-state">
              <div class="empty-state-icon">
                <i class="fas fa-exclamation-triangle"></i>
              </div>
              <h3 class="empty-state-title">加载失败</h3>
              <p class="empty-state-description">${message}</p>
              <button class="btn btn-primary" onclick="FPAPER.loadExams()">
                <i class="fas fa-redo"></i>
                重新加载
              </button>
            </div>
          </td>
        </tr>
      `;
    }
  },
  
  // 初始化事件监听器
  initEventListeners() {
    // 页面切换
    document.querySelectorAll('[data-page]').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const page = link.getAttribute('data-page');
        this.showPage(page);
      });
    });
    
    // 模态框关闭
    document.getElementById('close-download-modal').addEventListener('click', () => {
      this.hideModal('download-modal');
    });
    
    document.getElementById('cancel-download').addEventListener('click', () => {
      this.hideModal('download-modal');
    });
    
    document.getElementById('close-paper-details').addEventListener('click', () => {
      this.hideModal('paper-details-modal');
    });
    
    document.getElementById('close-details-modal').addEventListener('click', () => {
      this.hideModal('paper-details-modal');
    });
    
    // 搜索功能
    document.getElementById('search-papers-btn').addEventListener('click', () => {
      this.searchPapers();
    });
    
    document.getElementById('reset-search-btn').addEventListener('click', () => {
      this.resetSearch();
    });
    
    // 滚动效果
    window.addEventListener('scroll', () => {
      const navbar = document.querySelector('.navbar');
      if (window.scrollY > 50) {
        navbar.classList.add('scrolled');
      } else {
        navbar.classList.remove('scrolled');
      }
    });
    
    // 点击模态框外部关闭
    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('modal')) {
        const modalId = e.target.id;
        this.hideModal(modalId);
      }
    });
  },
  
  // 初始化UI
  initUI() {
    this.initFilters();
  },
  
  // 初始化筛选器
  initFilters() {
    this.initCategoryFilter();
    this.initYearFilter();
  },
  
  // 初始化分类筛选器
  initCategoryFilter() {
    const categoryFilter = document.getElementById('paper-category');
    
    categoryFilter.innerHTML = '<option value="">所有科目</option>';
    
    if (this.state.categories.size > 0) {
      const sortedCategories = Array.from(this.state.categories.values()).sort();
      sortedCategories.forEach(category => {
        const option = document.createElement('option');
        option.value = category;
        option.textContent = category;
        categoryFilter.appendChild(option);
      });
    }
  },
  
  // 初始化年份筛选器
  initYearFilter() {
    const yearFilter = document.getElementById('paper-year');
    yearFilter.innerHTML = '<option value="">所有年份</option>';
    
    const years = new Set();
    this.state.exams.forEach(exam => {
      years.add(exam.year);
    });
    
    if (years.size > 0) {
      const sortedYears = Array.from(years).sort((a, b) => b - a);
      sortedYears.forEach(year => {
        const option = document.createElement('option');
        option.value = year;
        option.textContent = year;
        yearFilter.appendChild(option);
      });
    }
  },
  
  // 显示加载状态
  showLoading() {
    const homeTable = document.getElementById('recent-papers-table');
    if (homeTable) {
      homeTable.innerHTML = `
        <div class="loading">
          <div class="loading-spinner"></div>
          <div class="loading-text">正在加载试卷数据...</div>
        </div>
      `;
    }
    
    const papersTable = document.getElementById('papers-table-body');
    if (papersTable) {
      papersTable.innerHTML = `
        <tr>
          <td colspan="4" style="text-align: center; padding: 40px;">
            <div class="loading">
              <div class="loading-spinner"></div>
              <div class="loading-text">正在加载试卷数据...</div>
            </div>
          </td>
        </tr>
      `;
    }
  },
  
  // 隐藏加载状态
  hideLoading() {
    // 不需要特别处理
  },
  
  // 显示数据源信息
  showDataSourceInfo() {
    const infoElement = document.getElementById('data-source-info');
    const examsCountElement = document.getElementById('loaded-exams-count');
    const papersCountElement = document.getElementById('loaded-papers-count');
    
    if (infoElement && examsCountElement && papersCountElement) {
      const totalPapers = this.state.exams.reduce((sum, exam) => sum + exam.papers.length, 0);
      
      examsCountElement.textContent = this.state.exams.length;
      papersCountElement.textContent = totalPapers;
      
      let sourceText = '';
      switch (this.state.dataSource) {
        case 'file':
          sourceText = 'data.txt + category.txt文件';
          break;
        default:
          sourceText = '未知数据源';
      }
      
      infoElement.innerHTML = `<i class="fas fa-database"></i> <span>数据源：${sourceText} | 共加载了${this.state.exams.length}个联考，${totalPapers}份试卷，${this.state.categories.size}个科目</span>`;
      infoElement.classList.remove('d-none');
    }
  },
  
  // 显示页面
  showPage(pageName) {
    const currentPage = this.state.currentPage;
    const pages = ['home', 'papers', 'about'];
    const currentIndex = pages.indexOf(currentPage);
    const targetIndex = pages.indexOf(pageName);
    
    // 添加导航历史
    this.state.navHistory.push(pageName);
    if (this.state.navHistory.length > 5) {
      this.state.navHistory.shift();
    }
    
    // 移除所有页面激活状态
    document.querySelectorAll('.page').forEach(page => {
      page.classList.remove('active');
    });
    
    // 移除所有导航链接激活状态
    document.querySelectorAll('.nav-link').forEach(link => {
      link.classList.remove('active');
      link.classList.remove('nav-slide-left');
      link.classList.remove('nav-slide-right');
    });
    
    // 添加目标页面激活状态
    const targetPage = document.getElementById(`${pageName}-page`);
    if (targetPage) {
      targetPage.classList.add('active');
      this.state.currentPage = pageName;
      
      // 更新导航链接激活状态
      document.querySelectorAll(`.nav-link[data-page="${pageName}"]`).forEach(link => {
        link.classList.add('active');
        
        // 添加导航动效
        if (targetIndex > currentIndex) {
          link.classList.add('nav-slide-right');
        } else if (targetIndex < currentIndex) {
          link.classList.add('nav-slide-left');
        }
      });
      
      // 根据页面加载内容
      switch (pageName) {
        case 'home':
          if (!this.state.isLoading) {
            this.renderRecentExams();
            this.updateStats();
          }
          break;
        case 'papers':
          if (!this.state.isLoading) {
            this.renderExamsTable();
          }
          break;
      }
    }
  },
  
  // 显示模态框
  showModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
      modal.classList.add('show');
      document.body.style.overflow = 'hidden';
    }
  },
  
  // 隐藏模态框
  hideModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
      modal.classList.remove('show');
      document.body.style.overflow = 'auto';
    }
  },
  
  // 显示下载确认模态框
  showDownloadModal(paperId) {
    // 在所有试卷中查找
    let targetPaper = null;
    for (const exam of this.state.exams) {
      const paper = exam.papers.find(p => p.id === paperId);
      if (paper) {
        targetPaper = paper;
        break;
      }
    }
    
    if (!targetPaper) return;
    
    document.getElementById('download-paper-name').textContent = targetPaper.name;
    document.getElementById('download-paper-url').textContent = targetPaper.url;
    
    const downloadLink = document.getElementById('confirm-download-link');
    downloadLink.href = targetPaper.url;
    downloadLink.setAttribute('target', '_blank');
    
    this.state.selectedPaperId = paperId;
    this.showModal('download-modal');
  },
  
  // 显示试卷详情模态框
  showPaperDetails(paperId) {
    // 在所有试卷中查找
    let targetPaper = null;
    let examName = '';
    for (const exam of this.state.exams) {
      const paper = exam.papers.find(p => p.id === paperId);
      if (paper) {
        targetPaper = paper;
        examName = exam.name;
        break;
      }
    }
    
    if (!targetPaper) return;
    
    document.getElementById('paper-details-title').textContent = targetPaper.name;
    
    let html = `
      <div style="margin-bottom: 20px;">
        <span class="paper-category" style="background: rgba(var(--primary-rgb, 16, 185, 129), 0.1); color: var(--primary); padding: 4px 12px; border-radius: var(--radius-md); font-size: 14px; font-weight: 600;">
          ${targetPaper.category}
        </span>
        <span style="margin-left: 10px; color: var(--gray-600);">
          <i class="fas fa-calendar-alt"></i> ${targetPaper.year}年
        </span>
      </div>
      <p style="margin-bottom: 10px; color: var(--gray-700);">
        <strong>所属联考：</strong>${examName}
      </p>
      <p style="margin-bottom: 10px; color: var(--gray-700);">
        <strong>发布日期：</strong>${targetPaper.date}
      </p>
      <p style="margin-bottom: 20px; color: var(--gray-700); line-height: 1.6;">
        ${targetPaper.description}
      </p>
      <div class="alert alert-info">
        <i class="fas fa-link"></i>
        <span>试卷链接：<a href="${targetPaper.url}" target="_blank">${targetPaper.url}</a></span>
      </div>
    `;
    
    document.getElementById('paper-details-content').innerHTML = html;
    document.getElementById('paper-download-btn').href = targetPaper.url;
    this.showModal('paper-details-modal');
  },
  
  // 搜索试卷
  searchPapers() {
    const searchTerm = document.getElementById('paper-search').value.toLowerCase();
    const category = document.getElementById('paper-category').value;
    const year = document.getElementById('paper-year').value;
    
    this.renderExamsTable(searchTerm, category, year);
  },
  
  // 重置搜索
  resetSearch() {
    document.getElementById('paper-search').value = '';
    document.getElementById('paper-category').value = '';
    document.getElementById('paper-year').value = '';
    this.renderExamsTable();
  },
  
  // 切换联考展开状态
  toggleExamExpansion(examId) {
    if (this.state.expandedExams.has(examId)) {
      this.state.expandedExams.delete(examId);
    } else {
      this.state.expandedExams.add(examId);
    }
    this.renderExamsTable(); // 重新渲染以更新展开状态
  },
  
  // 渲染最新联考
  renderRecentExams() {
    const container = document.getElementById('recent-papers-table');
    
    if (this.state.isLoading) {
      return;
    }
    
    if (this.state.exams.length === 0) {
      container.innerHTML = `
        <div class="empty-state">
          <div class="empty-state-icon">
            <i class="fas fa-book-open"></i>
          </div>
          <h3 class="empty-state-title">暂无联考数据</h3>
          <p class="empty-state-description">请确保data.txt和category.txt文件存在且格式正确。</p>
        </div>
      `;
      return;
    }
    
    const recentExams = [...this.state.exams]
      .sort((a, b) => b.year - a.year)
      .slice(0, 5);
    
    let html = `
      <table class="papers-table">
        <thead>
          <tr>
            <th>联考名称</th>
            <th>包含科目</th>
            <th>最新日期</th>
            <th>操作</th>
          </tr>
        </thead>
        <tbody>
    `;
    
    recentExams.forEach(exam => {
      html += `
        <tr class="exam-row" data-exam-id="${exam.id}">
          <td>
            <div style="font-weight: 600; font-size: 16px;">${exam.name}</div>
            <div style="font-size: 14px; color: var(--gray-600); margin-top: 4px;">
              共${exam.subjectCount}个科目
            </div>
          </td>
          <td>${exam.subjects.join('、')}</td>
          <td>${exam.formattedDate}</td>
          <td>
            <div class="action-buttons">
              <button class="btn btn-sm btn-primary expand-exam-btn" data-exam-id="${exam.id}">
                <i class="fas fa-chevron-down"></i>
                查看试卷
              </button>
            </div>
          </td>
        </tr>
      `;
      
      // 如果是展开状态，显示试卷详情
      if (this.state.expandedExams.has(exam.id)) {
        html += `
          <tr class="exam-details" data-exam-id="${exam.id}">
            <td colspan="4">
              <div class="exam-details-content">
                <h4 style="margin-bottom: 15px; color: var(--gray-800);">${exam.name} 包含试卷：</h4>
                <div style="display: grid; gap: 10px;">
        `;
        
        exam.papers.forEach(paper => {
          html += `
            <div class="exam-subject">
              <div>
                <div class="exam-subject-name">${paper.name}</div>
                <div class="exam-subject-date">${paper.date} | ${paper.category}</div>
              </div>
              <div class="action-buttons">
                <button class="btn btn-sm btn-primary download-paper-btn" data-id="${paper.id}">
                  <i class="fas fa-download"></i>
                  下载
                </button>
                <button class="btn btn-sm btn-outline view-paper-btn" data-id="${paper.id}">
                  <i class="fas fa-eye"></i>
                  查看
                </button>
              </div>
            </div>
          `;
        });
        
        html += `
                </div>
              </div>
            </td>
          </tr>
        `;
      }
    });
    
    html += `
        </tbody>
      </table>
    `;
    
    container.innerHTML = html;
    this.addPaperEventListeners();
  },
  
  // 渲染联考表格
  renderExamsTable(searchTerm = '', category = '', year = '') {
    const container = document.getElementById('papers-table-body');
    
    if (this.state.isLoading) {
      return;
    }
    
    if (this.state.exams.length === 0) {
      container.innerHTML = `
        <tr>
          <td colspan="4" style="text-align: center; padding: 40px;">
            <div class="empty-state">
              <div class="empty-state-icon">
                <i class="fas fa-search"></i>
              </div>
              <h3 class="empty-state-title">没有联考数据</h3>
              <p class="empty-state-description">请检查data.txt和category.txt文件是否存在且格式正确。</p>
            </div>
          </td>
        </tr>
      `;
      return;
    }
    
    let html = '';
    
    // 如果有分类筛选，则显示试卷列表而不是联考列表
    if (category) {
      const allPapers = [];
      this.state.exams.forEach(exam => {
        exam.papers.forEach(paper => {
          if (paper.category === category) {
            allPapers.push({...paper, examName: exam.name});
          }
        });
      });
      
      // 应用其他筛选条件
      let filteredPapers = allPapers;
      
      if (searchTerm) {
        filteredPapers = filteredPapers.filter(paper =>
          paper.name.toLowerCase().includes(searchTerm) ||
          paper.description.toLowerCase().includes(searchTerm) ||
          paper.examName.toLowerCase().includes(searchTerm)
        );
      }
      
      if (year) {
        filteredPapers = filteredPapers.filter(paper => paper.year.toString() === year);
      }
      
      filteredPapers.sort((a, b) => {
        if (b.year !== a.year) return b.year - a.year;
        if (b.month !== a.month) return b.month - a.month;
        return b.day - a.day;
      });
      
      if (filteredPapers.length === 0) {
        html = `
          <tr>
            <td colspan="4" style="text-align: center; padding: 40px;">
              <div class="empty-state">
                <div class="empty-state-icon">
                  <i class="fas fa-search"></i>
                </div>
                <h3 class="empty-state-title">没有找到试卷</h3>
                <p class="empty-state-description">尝试调整筛选条件。</p>
              </div>
            </td>
          </tr>
        `;
      } else {
        filteredPapers.forEach(paper => {
          html += `
            <tr data-id="${paper.id}">
              <td>
                <div style="font-weight: 600; font-size: 16px;">${paper.name}</div>
                <div style="font-size: 14px; color: var(--gray-600); margin-top: 4px;">
                  所属联考：${paper.examName}
                </div>
              </td>
              <td>${paper.category}</td>
              <td>${paper.date}</td>
              <td>
                <div class="action-buttons">
                  <button class="btn btn-sm btn-primary download-paper-btn" data-id="${paper.id}">
                    <i class="fas fa-download"></i>
                    下载
                  </button>
                  <button class="btn btn-sm btn-outline view-paper-btn" data-id="${paper.id}">
                    <i class="fas fa-eye"></i>
                    查看
                  </button>
                </div>
              </td>
            </tr>
          `;
        });
      }
    } else {
      // 没有分类筛选，显示联考列表
      let filteredExams = this.state.exams;
      
      if (searchTerm) {
        filteredExams = filteredExams.filter(exam =>
          exam.name.toLowerCase().includes(searchTerm) ||
          exam.description.toLowerCase().includes(searchTerm) ||
          exam.subjects.some(subject => subject.toLowerCase().includes(searchTerm))
        );
      }
      
      if (year) {
        filteredExams = filteredExams.filter(exam => exam.year.toString() === year);
      }
      
      filteredExams.sort((a, b) => b.year - a.year);
      
      if (filteredExams.length === 0) {
        html = `
          <tr>
            <td colspan="4" style="text-align: center; padding: 40px;">
              <div class="empty-state">
                <div class="empty-state-icon">
                  <i class="fas fa-search"></i>
                </div>
                <h3 class="empty-state-title">没有找到联考</h3>
                <p class="empty-state-description">尝试调整筛选条件。</p>
              </div>
            </td>
          </tr>
        `;
      } else {
        filteredExams.forEach(exam => {
          html += `
            <tr class="exam-row" data-exam-id="${exam.id}">
              <td>
                <div style="font-weight: 600; font-size: 16px;">${exam.name}</div>
                <div style="font-size: 14px; color: var(--gray-600); margin-top: 4px;">
                  共${exam.subjectCount}个科目
                </div>
              </td>
              <td>${exam.subjects.join('、')}</td>
              <td>${exam.formattedDate}</td>
              <td>
                <div class="action-buttons">
                  <button class="btn btn-sm btn-primary expand-exam-btn" data-exam-id="${exam.id}">
                    <i class="fas fa-chevron-down"></i>
                    查看试卷
                  </button>
                </div>
              </td>
            </tr>
          `;
          
          // 如果是展开状态，显示试卷详情
          if (this.state.expandedExams.has(exam.id)) {
            html += `
              <tr class="exam-details" data-exam-id="${exam.id}">
                <td colspan="4">
                  <div class="exam-details-content">
                    <h4 style="margin-bottom: 15px; color: var(--gray-800);">${exam.name} 包含试卷：</h4>
                    <div style="display: grid; gap: 10px;">
            `;
            
            exam.papers.forEach(paper => {
              html += `
                <div class="exam-subject">
                  <div>
                    <div class="exam-subject-name">${paper.name}</div>
                    <div class="exam-subject-date">${paper.date} | ${paper.category}</div>
                  </div>
                  <div class="action-buttons">
                    <button class="btn btn-sm btn-primary download-paper-btn" data-id="${paper.id}">
                      <i class="fas fa-download"></i>
                      下载
                    </button>
                    <button class="btn btn-sm btn-outline view-paper-btn" data-id="${paper.id}">
                      <i class="fas fa-eye"></i>
                      查看
                    </button>
                  </div>
                </div>
              `;
            });
            
            html += `
                    </div>
                  </div>
                </td>
              </tr>
            `;
          }
        });
      }
    }
    
    container.innerHTML = html;
    this.addPaperEventListeners();
  },
  
  // 添加试卷事件监听器
  addPaperEventListeners() {
    // 下载按钮
    document.querySelectorAll('.download-paper-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        const paperId = parseInt(btn.getAttribute('data-id'));
        this.showDownloadModal(paperId);
      });
    });
    
    // 查看按钮
    document.querySelectorAll('.view-paper-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        const paperId = parseInt(btn.getAttribute('data-id'));
        this.showPaperDetails(paperId);
      });
    });
    
    // 展开联考按钮
    document.querySelectorAll('.expand-exam-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        const examId = parseInt(btn.getAttribute('data-exam-id'));
        this.toggleExamExpansion(examId);
      });
    });
    
    // 点击联考行
    document.querySelectorAll('.exam-row').forEach(row => {
      row.addEventListener('click', (e) => {
        if (!e.target.closest('.action-buttons')) {
          const examId = parseInt(row.getAttribute('data-exam-id'));
          this.toggleExamExpansion(examId);
        }
      });
    });
  },
  
  // 更新统计信息
  updateStats() {
    if (this.state.isLoading || this.state.exams.length === 0) {
      document.getElementById('total-papers').textContent = '0';
      document.getElementById('total-years').textContent = '0';
      document.getElementById('total-categories').textContent = '0';
      document.getElementById('latest-year').textContent = '2025';
      return;
    }
    
    const totalPapers = this.state.exams.reduce((sum, exam) => sum + exam.papers.length, 0);
    document.getElementById('total-papers').textContent = totalPapers;
    
    const years = new Set();
    this.state.exams.forEach(exam => {
      exam.papers.forEach(paper => {
        years.add(paper.year);
      });
    });
    
    const yearSpan = years.size > 0 ? 
      `${Math.min(...Array.from(years))}-${Math.max(...Array.from(years))}` : '0';
    document.getElementById('total-years').textContent = yearSpan;
    
    document.getElementById('total-categories').textContent = this.state.categories.size;
    
    const latestYear = this.state.exams.length > 0 ?
      Math.max(...this.state.exams.map(exam => exam.year)) : 2025;
    document.getElementById('latest-year').textContent = latestYear;
  }
};

// 页面加载完成后初始化应用程序
document.addEventListener('DOMContentLoaded', () => {
  FPAPER.init();
});
</script>
</body>
</html>